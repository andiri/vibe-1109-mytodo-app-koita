<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyToDo ğŸ“</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ -->
    <div id="toastContainer" class="toast-container"></div>

    <div class="container">
        <!-- í—¤ë” (Viewing Area) -->
        <header class="header">
            <div class="header-top">
                <h1>MyToDo</h1>
                <button id="themeToggle" class="theme-toggle" aria-label="ë‹¤í¬ëª¨ë“œ í† ê¸€">
                    <span class="theme-icon">ğŸŒ™</span>
                </button>
            </div>
            <p class="header-subtitle">ì˜¤ëŠ˜ì˜ í•  ì¼ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
        </header>

        <!-- í†µê³„ ì˜ì—­ (Viewing Area) -->
        <div class="stats-top">
            <div class="stat-card">
                <span class="stat-label">ì „ì²´</span>
                <span class="stat-value" id="totalCount">0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">ì™„ë£Œ</span>
                <span class="stat-value primary" id="completedCount">0</span>
            </div>
            <div class="stat-card">
                <span class="stat-label">ì§„í–‰ì¤‘</span>
                <span class="stat-value secondary" id="remainingCount">0</span>
            </div>
        </div>

        <!-- í•„í„° & ê´€ë¦¬ ì˜ì—­ -->
        <div class="filter-section">
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">ì „ì²´</button>
                <button class="filter-btn" data-filter="active">ì§„í–‰ì¤‘</button>
                <button class="filter-btn" data-filter="completed">ì™„ë£Œ</button>
            </div>
            <button id="clearCompleted" class="clear-btn">ì™„ë£Œ ì‚­ì œ</button>
        </div>

        <!-- í•  ì¼ ë¦¬ìŠ¤íŠ¸ (Viewing Area) -->
        <ul id="todoList" class="todo-list">
            <!-- JavaScriptë¡œ ë™ì  ìƒì„±ë¨ -->
        </ul>

        <!-- ì…ë ¥ ì˜ì—­ (Interaction Area - One UI ì›ì¹™) -->
        <div class="input-section">
            <div class="input-wrapper">
                <input 
                    type="text" 
                    id="todoInput" 
                    class="todo-input" 
                    placeholder="ìƒˆë¡œìš´ í•  ì¼ ì¶”ê°€..."
                    autocomplete="off"
                >
                <button id="addBtn" class="add-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                        <path d="M12 5v14M5 12h14"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- í‘¸í„° (ê°œë°œì ì •ë³´) -->
        <footer class="app-footer">
            <p class="footer-text">Made by <strong>JUN.VIBE</strong> & <strong>Cursor</strong></p>
        </footer>
    </div>

    <script>
        // ============================================
        // ğŸ“¦ DOM ìš”ì†Œ ì„ íƒ
        // ============================================
        const todoInput = document.getElementById('todoInput');
        const addBtn = document.getElementById('addBtn');
        const todoList = document.getElementById('todoList');
        const totalCount = document.getElementById('totalCount');
        const completedCount = document.getElementById('completedCount');
        const remainingCount = document.getElementById('remainingCount');
        const themeToggle = document.getElementById('themeToggle');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const clearCompletedBtn = document.getElementById('clearCompleted');
        const toastContainer = document.getElementById('toastContainer');

        // ============================================
        // ğŸ’¾ ë°ì´í„° ê´€ë¦¬ (localStorage)
        // ============================================
        let todos = []; // í•  ì¼ ë°°ì—´
        let currentFilter = 'all'; // í˜„ì¬ í•„í„° ìƒíƒœ

        // localStorageì—ì„œ í•  ì¼ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadTodos() {
            const saved = localStorage.getItem('todos');
            todos = saved ? JSON.parse(saved) : [];
        }

        // localStorageì— í•  ì¼ ì €ì¥í•˜ê¸°
        function saveTodos() {
            localStorage.setItem('todos', JSON.stringify(todos));
        }

        // ============================================
        // ğŸ‰ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ê¸°ëŠ¥
        // ============================================
        function showToast(message, type = 'info') {
            // í† ìŠ¤íŠ¸ ìš”ì†Œ ìƒì„±
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            // íƒ€ì…ë³„ ì•„ì´ì½˜
            const icons = {
                success: 'âœ“',
                error: 'âœ•',
                info: 'â„¹',
                warning: 'âš '
            };
            
            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || icons.info}</span>
                <span class="toast-message">${message}</span>
            `;
            
            // í† ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆì— ì¶”ê°€
            toastContainer.appendChild(toast);
            
            // 3ì´ˆ í›„ ìë™ ì œê±°
            setTimeout(() => {
                toast.classList.add('toast-hiding');
                setTimeout(() => {
                    toast.remove();
                }, 300); // ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„
            }, 3000);
        }

        // ============================================
        // ğŸ¨ ë‹¤í¬ëª¨ë“œ ê¸°ëŠ¥
        // ============================================
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateThemeIcon(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });

        function updateThemeIcon(theme) {
            const icon = themeToggle.querySelector('.theme-icon');
            icon.textContent = theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        }

        // ============================================
        // âœ¨ í•  ì¼ ë Œë”ë§
        // ============================================
        function renderTodos() {
            // í•„í„°ë§ëœ í•  ì¼ë§Œ í‘œì‹œ
            const filteredTodos = todos.filter(todo => {
                if (currentFilter === 'all') return true;
                if (currentFilter === 'completed') return todo.completed;
                if (currentFilter === 'active') return !todo.completed;
            });

            // ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
            todoList.innerHTML = '';

            // í•  ì¼ì´ ì—†ì„ ë•Œ
            if (filteredTodos.length === 0) {
                return; // CSSì˜ :empty ê°€ìƒ ì„ íƒìê°€ ë©”ì‹œì§€ í‘œì‹œ
            }

            // ê° í•  ì¼ ë Œë”ë§
            filteredTodos.forEach(todo => {
                const li = document.createElement('li');
                li.className = `todo-item ${todo.completed ? 'completed' : ''}`;
                li.dataset.id = todo.id;
                li.innerHTML = `
                    <div class="todo-checkbox-wrapper">
                        <input type="checkbox" class="todo-checkbox" id="todo${todo.id}" ${todo.completed ? 'checked' : ''}>
                        <label for="todo${todo.id}" class="checkbox-label"></label>
                    </div>
                    <span class="todo-text" contenteditable="false">${todo.text}</span>
                    <button class="delete-btn" aria-label="ì‚­ì œ">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12"/>
                        </svg>
                    </button>
                `;
                todoList.appendChild(li);
            });

            updateStats();
        }

        // ============================================
        // ğŸ“Š í†µê³„ ì—…ë°ì´íŠ¸
        // ============================================
        function updateStats() {
            const total = todos.length;
            const completed = todos.filter(t => t.completed).length;
            const active = total - completed;

            totalCount.textContent = total;
            completedCount.textContent = completed;
            remainingCount.textContent = active;

            // ì™„ë£Œëœ í•­ëª©ì´ ì—†ìœ¼ë©´ ì‚­ì œ ë²„íŠ¼ ë¹„í™œì„±í™”
            clearCompletedBtn.disabled = completed === 0;
        }

        // ============================================
        // â• í•  ì¼ ì¶”ê°€
        // ============================================
        function addTodo() {
            const text = todoInput.value.trim();
            if (!text) {
                showToast('í•  ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'warning');
                return;
            }

            // ìƒˆë¡œìš´ í•  ì¼ ê°ì²´ ìƒì„±
            const newTodo = {
                id: Date.now(), // ê³ ìœ  ID (íƒ€ì„ìŠ¤íƒ¬í”„ ì‚¬ìš©)
                text: text,
                completed: false,
                createdAt: new Date().toISOString()
            };

            todos.push(newTodo);
            saveTodos();
            renderTodos();
            todoInput.value = '';
            todoInput.focus();
            
            // ì„±ê³µ ë©”ì‹œì§€
            showToast(`"${text}" í•  ì¼ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
        }

        // ============================================
        // âœï¸ í•  ì¼ ìˆ˜ì • (ë”ë¸”í´ë¦­)
        // ============================================
        function editTodo(todoElement, todoId) {
            const textSpan = todoElement.querySelector('.todo-text');
            const originalText = textSpan.textContent;

            // ìˆ˜ì • ëª¨ë“œë¡œ ì „í™˜
            textSpan.contentEditable = true;
            textSpan.focus();
            textSpan.classList.add('editing');

            // í…ìŠ¤íŠ¸ ì „ì²´ ì„ íƒ
            const range = document.createRange();
            range.selectNodeContents(textSpan);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);

            // ìˆ˜ì • ì™„ë£Œ ì²˜ë¦¬
            function finishEdit() {
                textSpan.contentEditable = false;
                textSpan.classList.remove('editing');
                const newText = textSpan.textContent.trim();

                if (!newText) {
                    textSpan.textContent = originalText;
                    return;
                }

                if (newText !== originalText) {
                    const todo = todos.find(t => t.id === todoId);
                    if (todo) {
                        todo.text = newText;
                        saveTodos();
                        showToast('í•  ì¼ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
                    }
                }
            }

            // Enter í‚¤ë¡œ ìˆ˜ì • ì™„ë£Œ
            textSpan.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    finishEdit();
                }
                if (e.key === 'Escape') {
                    textSpan.textContent = originalText;
                    finishEdit();
                }
            });

            // í¬ì»¤ìŠ¤ ìƒìœ¼ë©´ ìˆ˜ì • ì™„ë£Œ
            textSpan.addEventListener('blur', finishEdit, { once: true });
        }

        // ============================================
        // âŒ í•  ì¼ ì‚­ì œ
        // ============================================
        function deleteTodo(todoId) {
            const todo = todos.find(t => t.id === todoId);
            const todoText = todo ? todo.text : 'í•  ì¼';
            
            todos = todos.filter(t => t.id !== todoId);
            saveTodos();
            renderTodos();
            
            showToast(`"${todoText}" í•  ì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`, 'error');
        }

        // ============================================
        // âœ… ì™„ë£Œ ìƒíƒœ í† ê¸€
        // ============================================
        function toggleComplete(todoId) {
            const todo = todos.find(t => t.id === todoId);
            if (todo) {
                todo.completed = !todo.completed;
                saveTodos();
                renderTodos();
                
                const message = todo.completed 
                    ? `"${todo.text}" ì™„ë£Œ!` 
                    : `"${todo.text}" ë‹¤ì‹œ ì§„í–‰ì¤‘`;
                showToast(message, todo.completed ? 'success' : 'info');
            }
        }

        // ============================================
        // ğŸ” í•„í„° ê¸°ëŠ¥
        // ============================================
        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                filterBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                renderTodos();
                
                const filterNames = {
                    all: 'ì „ì²´',
                    active: 'ì§„í–‰ì¤‘',
                    completed: 'ì™„ë£Œ'
                };
                showToast(`${filterNames[currentFilter]} í•­ëª© ë³´ê¸°`, 'info');
            });
        });

        // ============================================
        // ğŸ—‘ï¸ ì™„ë£Œëœ í•­ëª© ì¼ê´„ ì‚­ì œ
        // ============================================
        clearCompletedBtn.addEventListener('click', () => {
            const completedCount = todos.filter(t => t.completed).length;
            if (completedCount === 0) return;

            if (confirm(`ì™„ë£Œëœ ${completedCount}ê°œì˜ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                todos = todos.filter(t => !t.completed);
                saveTodos();
                renderTodos();
                showToast(`${completedCount}ê°œì˜ ì™„ë£Œëœ í•  ì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
            }
        });

        // ============================================
        // ğŸ¯ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        // ============================================
        
        // í•  ì¼ ì¶”ê°€ (ë²„íŠ¼ í´ë¦­)
        addBtn.addEventListener('click', addTodo);

        // í•  ì¼ ì¶”ê°€ (Enter í‚¤)
        todoInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addTodo();
        });

        // í•  ì¼ ë¦¬ìŠ¤íŠ¸ ì´ë²¤íŠ¸ (ì´ë²¤íŠ¸ ìœ„ì„)
        todoList.addEventListener('click', (e) => {
            const todoItem = e.target.closest('.todo-item');
            if (!todoItem) return;

            const todoId = parseInt(todoItem.dataset.id);

            // ì²´í¬ë°•ìŠ¤ í´ë¦­ - ì™„ë£Œ í† ê¸€
            if (e.target.classList.contains('todo-checkbox')) {
                toggleComplete(todoId);
            }

            // ì‚­ì œ ë²„íŠ¼ í´ë¦­
            if (e.target.closest('.delete-btn')) {
                todoItem.style.opacity = '0';
                todoItem.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    deleteTodo(todoId);
                }, 300);
            }
        });

        // ë”ë¸”í´ë¦­ìœ¼ë¡œ ìˆ˜ì •
        todoList.addEventListener('dblclick', (e) => {
            const todoItem = e.target.closest('.todo-item');
            if (!todoItem) return;

            const todoId = parseInt(todoItem.dataset.id);
            editTodo(todoItem, todoId);
        });

        // ============================================
        // ğŸš€ ì•± ì´ˆê¸°í™”
        // ============================================
        function init() {
            loadTodos();
            renderTodos();
            console.log('âœ… MyToDo ì•±ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!');
            console.log(`ğŸ“ ì €ì¥ëœ í•  ì¼: ${todos.length}ê°œ`);
        }

        // ì•± ì‹œì‘
        init();
    </script>
</body>
</html>

